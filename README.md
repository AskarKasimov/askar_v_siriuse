# Решения заданий НТО ИБ 2023 от команды аскар_в_сириусе
## Блок 1 — CTF
### WEB 1
Поиск путей на сайте через утилиты по типу **dirb** результатов не дал.

Однако анализ клиентских **JS**-скриптов показал, что сайт турфирмы для уточнения цены поездки использует подключение по **WebSokcet**, отправляя при нажатии кнопки зашифрованные данные о выбранных пунктах в формате **JSON**.

Расшифровка даётся легко, ведь дешифрующий код находится в тех же скриптах с интуитивно понятными названиями функций.

Анализ отправки валидных данных на **WebSocket** по указанному в скриптах адресу дал понять, что сервер не оперирует никакими базами данных, и **SQL**-инъекции здесь бесполезны. Также было выявлено, что элементы поля *countries* никак не обрабатываются (в отличие от *startdate* и *enddate*), решает лишь их количество.

Заметим, что для десериализации **JSON** в скриптах используется стандартный метод **JSON.parse()**, который, как известно, с таким же успехом способен обрабатывать **XML**. Заменив поле *format* с **JSON** на **XML**, можно с лёгкостью написать **XML**-инъекцию, позволяющую прочитать файл с сервера:

```
<!DOCTYPE foo [ <!ENTITY injection SYSTEM "file:///flag.txt"> ]><countries>&injection;</countries><enddate/><startdate/><resttype/>
```
